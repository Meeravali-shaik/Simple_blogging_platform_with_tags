{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>Settings</h2>

    <!-- Change Username -->
    <form action="{{ url_for('change_username') }}" method="POST" class="mb-4">
        <div class="mb-3">
            <label for="newUsername" class="form-label">Change Username</label>
            <input
                type="text"
                class="form-control"
                id="newUsername"
                name="newUsername"
                placeholder="Enter new username"
                required
            >
        </div>
        <button type="submit" class="btn btn-primary">Update Username</button>
    </form>

    <!-- Change Password -->
    <form action="{{ url_for('change_password') }}" method="POST" class="mb-4">
        <div class="mb-3">
            <label for="currentPassword" class="form-label">Current Password</label>
            <input
                type="password"
                class="form-control"
                id="currentPassword"
                name="currentPassword"
                placeholder="Enter current password"
                required
            >
        </div>
        <div class="mb-3">
            <label for="newPassword" class="form-label">New Password</label>
            <input
                type="password"
                class="form-control"
                id="newPassword"
                name="newPassword"
                placeholder="Enter new password"
                required
            >
        </div>
        <div class="mb-3">
            <label for="confirmPassword" class="form-label">Confirm New Password</label>
            <input
                type="password"
                class="form-control"
                id="confirmPassword"
                name="confirmPassword"
                placeholder="Confirm new password"
                required
            >
        </div>
        <button type="submit" class="btn btn-warning">Update Password</button>
    </form>

    <!-- Update Email -->
    <form action="{{ url_for('update_email') }}" method="POST" class="mb-4">
        <div class="mb-3">
            <label for="newEmail" class="form-label">Update Email</label>
            <input
                type="email"
                class="form-control"
                id="newEmail"
                name="newEmail"
                placeholder="Enter new email"
                required
            >
        </div>
        <button type="submit" class="btn btn-info">Update Email</button>
    </form>



    <!-- Appearance Settings -->
    <h3>Appearance</h3>
    <div class="form-check form-switch">
        <input
            class="form-check-input"
            type="checkbox"
            id="themeSwitch"
            onchange="toggleTheme(this)"
        >
        <label class="form-check-label" for="themeSwitch">Dark Mode</label>
    </div>

    <!-- Logout -->
    <div class="mt-4">
        <a href="{{ url_for('logout') }}" class="btn btn-danger">Logout</a>
    </div>
</div>

<script>
    // Toggle theme and store preference in localStorage
    function toggleTheme(element) {
        if (element.checked) {
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
        } else {
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
        }
    }

    // Load theme preference on page load
    window.onload = function () {
        const theme = localStorage.getItem('theme');
        if (theme === 'dark') {
            document.body.classList.add('dark-mode');
            document.getElementById('themeSwitch').checked = true;
        }
    };
</script>

<style>
    .dark-mode {
        background-color: #121212;
        color: #ffffff;
    }
</style>
{% endblock %}